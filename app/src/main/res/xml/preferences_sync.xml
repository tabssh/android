<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">

    <!-- Step 1: Choose Backend -->
    <PreferenceCategory android:title="Step 1: Choose Sync Backend">

        <ListPreference
            android:key="sync_backend"
            android:title="Sync backend"
            android:summary="%s"
            android:entries="@array/sync_backend_entries"
            android:entryValues="@array/sync_backend_values"
            android:defaultValue="auto" />

    </PreferenceCategory>

    <!-- Step 2a: Google Drive Settings -->
    <PreferenceCategory
        android:key="category_google_drive"
        android:title="Step 2: Google Drive Settings">

        <Preference
            android:key="sync_account"
            android:title="Google account"
            android:summary="Not connected - tap to sign in" />

        <EditTextPreference
            android:key="google_drive_sync_folder"
            android:title="Google Drive folder"
            android:summary="Folder name in appDataFolder (default: tabssh)"
            android:defaultValue="tabssh" />

    </PreferenceCategory>

    <!-- Step 2b: WebDAV Settings -->
    <PreferenceCategory
        android:key="category_webdav"
        android:title="Step 2: WebDAV Settings">

        <EditTextPreference
            android:key="webdav_server_url"
            android:title="Server URL"
            android:summary="e.g. https://cloud.example.com/remote.php/dav/files/user"
            android:inputType="textUri" />

        <EditTextPreference
            android:key="webdav_username"
            android:title="Username"
            android:summary="Your WebDAV username" />

        <EditTextPreference
            android:key="webdav_password"
            android:title="Password"
            android:summary="App-specific password (recommended)"
            android:inputType="textPassword" />

        <EditTextPreference
            android:key="webdav_sync_folder"
            android:title="Sync folder path"
            android:summary="Remote folder for sync data (default: /tabssh)"
            android:defaultValue="/tabssh" />

        <Preference
            android:key="webdav_test_connection"
            android:title="Test connection"
            android:summary="Verify server connectivity" />

    </PreferenceCategory>

    <!-- Step 3: Security -->
    <PreferenceCategory android:title="Step 3: Security">

        <Preference
            android:key="sync_password"
            android:title="Encryption password"
            android:summary="Required - encrypts all synced data (AES-256)" />

    </PreferenceCategory>

    <!-- Step 4: Enable Sync -->
    <PreferenceCategory android:title="Step 4: Enable Sync">

        <SwitchPreferenceCompat
            android:key="sync_enabled"
            android:title="Enable sync"
            android:summary="Complete steps 1-3 above first"
            android:defaultValue="false" />

        <Preference
            android:key="sync_status"
            android:title="Status"
            android:summary="Not configured"
            android:selectable="false"
            android:dependency="sync_enabled" />

    </PreferenceCategory>

    <!-- Sync Options (only visible when enabled) -->
    <PreferenceCategory
        android:title="Sync Options"
        android:dependency="sync_enabled">

        <ListPreference
            android:key="sync_frequency"
            android:title="Sync frequency"
            android:summary="%s"
            android:entries="@array/sync_frequency_entries"
            android:entryValues="@array/sync_frequency_values"
            android:defaultValue="1h" />

        <SwitchPreferenceCompat
            android:key="sync_wifi_only"
            android:title="WiFi only"
            android:summary="Only sync when connected to WiFi"
            android:defaultValue="true" />

        <SwitchPreferenceCompat
            android:key="sync_on_change"
            android:title="Sync on change"
            android:summary="Automatically sync when data changes"
            android:defaultValue="true" />

        <SwitchPreferenceCompat
            android:key="sync_auto_resolve"
            android:title="Auto-resolve conflicts"
            android:summary="Use timestamps to resolve conflicts"
            android:defaultValue="true" />

    </PreferenceCategory>

    <!-- What to Sync -->
    <PreferenceCategory
        android:title="What to Sync"
        android:dependency="sync_enabled">

        <SwitchPreferenceCompat
            android:key="sync_connections"
            android:title="Connections"
            android:summary="SSH connection profiles"
            android:defaultValue="true" />

        <SwitchPreferenceCompat
            android:key="sync_keys"
            android:title="SSH keys"
            android:summary="Key metadata (not private keys)"
            android:defaultValue="true" />

        <SwitchPreferenceCompat
            android:key="sync_settings"
            android:title="App settings"
            android:summary="Preferences and settings"
            android:defaultValue="true" />

        <SwitchPreferenceCompat
            android:key="sync_themes"
            android:title="Themes"
            android:summary="Custom terminal themes"
            android:defaultValue="true" />

    </PreferenceCategory>

    <!-- Actions -->
    <PreferenceCategory
        android:title="Actions"
        android:dependency="sync_enabled">

        <Preference
            android:key="sync_manual_trigger"
            android:title="Sync now"
            android:summary="Manually trigger sync" />

        <Preference
            android:key="sync_last_time"
            android:title="Last sync"
            android:summary="Never synced"
            android:selectable="false" />

    </PreferenceCategory>

    <!-- Advanced -->
    <PreferenceCategory
        android:title="Advanced"
        android:dependency="sync_enabled">

        <Preference
            android:key="sync_force_upload"
            android:title="Force upload"
            android:summary="Upload local data, overwrite remote" />

        <Preference
            android:key="sync_force_download"
            android:title="Force download"
            android:summary="Download remote data, overwrite local" />

        <Preference
            android:key="sync_clear_data"
            android:title="Clear remote data"
            android:summary="Remove all synced data from server" />

    </PreferenceCategory>

</PreferenceScreen>
